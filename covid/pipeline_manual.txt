#### Manual Pipeline for SARS-CoV-2 lineage uncertainty ####

# Manual because each step takes a while
#   - Downloading: ~10-20 mins per file
#   - Parsing: due to inefficiencies, about 5 hours per file
# Also manual because of filename manipulation
#   - Could be solved by learning more shell scripting commands




#### Step 1: access SAM files
# 10 - 20 minutes per download
Rscript covid/create_sam_commands.R
export PATH=$PATH:~/Downloads/sratoolkit.2.10.8-ubuntu64/bin
# Copy/paste commands from Rscript into command line





#### Step 2: parse SAM files into uncertainty matrices
# 4 to 8 hours per file
# Ensure files are in either current directory or ./samTODO
#   - TODO: remove this restriction for more generalizability
# Currently only works for paired=FALSE (TODO)
Rscript covid/open_seSAMe_dir.R
# or: nohup Rscript open_seSAMe_dir.R &
#   - TODO: error checking for file names




#### Step 3: Generate sequences from uncertainty matrices
# About 1 minute per file
Rscript covid/sample_S_dir.R




#### Step 4: Send files into pangolin
# *** Code generated in Step 3




#### Step 5: Visualize!
Rscript covid/pangolin_results_dir.R







